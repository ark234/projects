<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Level 8</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="../css/master.css">
	<link rel="stylesheet" href="../css/level8.css">

  </head>
  <body>
    <!-- Platforms -->
    <div class="platform-container">
      <div class="platform-win"></div>
      <div class="platform-start"></div>
      <div class="platform" id="bus-one"></div>
      <div class="platform" id="bus-two"></div>
      <div class="platform" id="one"></div>
      <div class="platform" id="two"></div>
      <div class="platform" id="two"></div>
      <div class="obstacle" id="html"></div>
      <div class="obstacle" id="css"></div>
      <div class="obstacle" id="js"></div>
    </div>

    <!-- Nav Menu at the bottom of the screen -->
    <nav>
      <a href="level7.html"><button id="previous">Previous Level</button></a>
      <a href="../index.html"><button id="main">Main Menu</button></a>
    </nav>

    <!-- Win and Lose Modals -->
    <div class="modal" id="modal-win">
      <div class="modal-content">
        <p>You Win!</p>
        <nav>
          <a href="level8.html"><button id="next">Next Level</button></a>
          <a href="../index.html"><button id="main">Main Menu</button></a>
        </nav>
      </div>
    </div>
    <div class="modal" id="modal-lose">
      <div class="modal-content">
        <p>You Lose!</p>
        <nav>
          <a href="level8.html"><button id="retry">Retry</button></a>
          <a href="../index.html"><button id="main">Main Menu</button></a>
        </nav>
      </div>
    </div>

  <script>
  var modalWin = document.getElementById("modal-win");
  var modalLose = document.getElementById("modal-lose");
  var live = false;		// This forces player to start at start platform
  var container = document.getElementsByClassName("platform-container")[0];
  var p2 = document.getElementById("two");
  
  /************************************************************
                          HOVER LOGIC
  ************************************************************/

  /* Game starts when you hover over the start platform  */
  $(".platform-start").mouseenter(function(event) {
    live = true;
	container.style.cursor = "crosshair";
  });
  
  /* If you hover off of start platform not onto another platform, you lose  */
  $(".platform-start").mouseleave(function(event) {
    if(!$(event.relatedTarget).hasClass("platform")) {
      modalLose.style.display = "block";
      container.style.cursor = "default";
    }
  });
  
  $(".platform").mouseenter(function(event) {
    if($(event.relatedTarget).hasClass("platform-start") ||
	   $(event.relatedTarget).hasClass("platform") ||
	   $(event.relatedTarget).hasClass("power-up")) {
      // do nothing
    } else {
      live = false;
      container.style.cursor = "default";
    }
  });

  /* Whenever you hover off .platform elements, it will check if the element you're hovering onto (related target) is .platform-win, in which case you win. If you hover from .platform to .platform, then nothing will happen. If you hover onto something other than .platform or .platform-win, you lose. */
  $(".platform").mouseleave(function(event) {
    if($(event.relatedTarget).hasClass("platform-win")) {
      if (live) {
        modalWin.style.display = "block";
        container.style.cursor = "default";
      }
    } 
	else if($(event.relatedTarget).hasClass("platform") ||
			  $(event.relatedTarget).hasClass("platform-start") ||
			  $(event.relatedTarget).hasClass("power-up")) {
      // do nothing
    } 
	else {
      if (live) {
        modalLose.style.display = "block";
        container.style.cursor = "default";
      }
      live = false;
    }
  });
  
  /* #bus-one logic */
  $("#bus-one").mouseenter(function() {
    if(live) {
		  move1();
	  }
  });
  /* #bus-two logic */
  $("#bus-two").mouseenter(function() {
    if(live) {
      move2();
    }
  });

  /************************************************************
                          JS ANIMATIONS
  ************************************************************/

	function move1() {
		var bus1 = document.getElementById("bus-one");
		var pos = 100;
		var interval = setInterval(frame, 5);

		function frame() {
			pos++;

			if(pos <= 1040) {
				bus1.style.left = `${pos}px`;
			} else {
        clearInterval(interval);
      }
		}
	}
  function move2() {
    var bus2 = document.getElementById("bus-two");
    var pos = 1040;
    var interval = setInterval(frame, 5);

    function frame() {
      pos--;

      if(pos >= 0) {
        bus2.style.left = `${pos}px`;
      } else {
        clearInterval(interval);
      }
    }
  }

    </script>
  </body>
</html>
